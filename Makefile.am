#  OpenVPN-GUI -- A Windows GUI for OpenVPN.
#
#  Copyright (C) 2004 Mathias Sundman <mathias@nilings.se>
#                2010 Heiko Hund <heikoh@users.sf.net>
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program (see the file COPYING included with this
#  distribution); if not, write to the Free Software Foundation, Inc.,
#  59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

SUFFIXES = .rc

AUTOMAKE_OPTIONS = foreign 1.9
ACLOCAL_AMFLAGS = -I m4

MAINTAINERCLEANFILES = \
	config.log config.status \
	$(srcdir)/Makefile.in  $(srcdir)/configure \
	$(srcdir)/config.h.in $(srcdir)/config.h.in~\
	$(srcdir)/install-sh $(srcdir)/missing \
	$(srcdir)/depcomp $(srcdir)/aclocal.m4 \
	$(srcdir)/config.guess $(srcdir)/config.sub

EXTRA_DIST = .gitignore

bin_PROGRAMS = openvpn-gui

dist_doc_DATA = \
	COPYRIGHT.GPL \
	COPYING

INCLUDES = $(OPENSSL_CRYPTO_CFLAGS)
AM_CPPFLAGS = -D_UNICODE
AM_CFLAGS = -municode

openvpn_gui_RESOURCES = \
	res/openvpn-gui-res-de.rch \
	res/openvpn-gui-res-dk.rch \
	res/openvpn-gui-res-en.rch \
	res/openvpn-gui-res-es.rch \
	res/openvpn-gui-res-fi.rch \
	res/openvpn-gui-res-fr.rch \
	res/openvpn-gui-res-it.rch \
	res/openvpn-gui-res-jp.rch \
	res/openvpn-gui-res-nl.rch \
	res/openvpn-gui-res-no.rch \
	res/openvpn-gui-res-pl.rch \
	res/openvpn-gui-res-pt.rch \
	res/openvpn-gui-res-se.rch \
	res/openvpn-gui-res-tr.rch \
	res/connected.ico \
	res/connecting.ico \
	res/disconnected.ico \
	res/openvpn-gui.ico \
	res/reconnecting.ico \
	res/openvpn-gui.manifest

openvpn_gui_SOURCES = \
	main.c main.h \
	openvpn.c openvpn.h \
	localization.c localization.h \
	tray.c tray.h \
	viewlog.c viewlog.h \
	service.c service.h \
	options.c options.h \
	passphrase.c passphrase.h \
	proxy.c proxy.h \
	registry.c registry.h \
	scripts.c scripts.h \
	manage.c manage.h \
	misc.c misc.h \
	openvpn_config.c \
	openvpn_config.h \
	chartable.h \
	openvpn-gui-res.h \
	res/openvpn-gui-res.rc \
	$(openvpn_gui_RESOURCES)

openvpn_gui_LDADD = \
	$(OPENSSL_CRYPTO_LIBS) \
	-lws2_32 \
	-lcomctl32
openvpn_gui_LDFLAGS = \
	-mwindows

$(srcdir)/res/openvpn-gui-res.rc: $(openvpn_gui_RESOURCES) $(srcdir)/openvpn-gui-res.h
	touch "$(srcdir)/res/openvpn-gui-res.rc"

RCCOMPILE = $(WINDRES) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
	$(AM_CPPFLAGS) $(CPPFLAGS)
.rc.o:
	$(RCCOMPILE) -i $< -o $@
